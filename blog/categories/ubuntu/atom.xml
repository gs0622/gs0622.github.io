<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ubuntu | Harry's Graffiti]]></title>
  <link href="http://gs0622.github.io/blog/categories/ubuntu/atom.xml" rel="self"/>
  <link href="http://gs0622.github.io/"/>
  <updated>2014-09-17T19:10:24+08:00</updated>
  <id>http://gs0622.github.io/</id>
  <author>
    <name><![CDATA[Harry Pan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Linux Administration Notes]]></title>
    <link href="http://gs0622.github.io/blog/2014/09/10/linux-administration-notes/"/>
    <updated>2014-09-10T11:28:23+08:00</updated>
    <id>http://gs0622.github.io/blog/2014/09/10/linux-administration-notes</id>
    <content type="html"><![CDATA[<p>Here is a memo of Linux workstation administration FAQs</p>

<h2>Add new hard disk</h2>

<h4>Find new disk to setup</h4>

<pre><code>$ sudo fdisk -l
</code></pre>

<p><img src="/images/20140910_list_partition.png" width="600" height="500" title="find new disk to setup" ></p>

<h4>Create extend/logical partition</h4>

<pre><code>Command: n -&gt; e -&gt; enter (default) -&gt; enter (default)
</code></pre>

<p><img src="/images/20140910_ext_partition.png" width="600" height="500" title="create extended partition" ></p>

<pre><code>Command: n -&gt; l -&gt; enter (default) -&gt; enter (default)
</code></pre>

<p><img src="/images/20140910_logical_partition.png" width="600" height="500" title="create logical partition" ></p>

<h4>Exame then write partition table to disk</h4>

<pre><code>Command: p (print) -&gt; w (write)
</code></pre>

<p><img src="/images/20140910_write_table.png" width="600" height="500" title="exame then write partition table" ></p>

<h4>Format new disk to ext4</h4>

<pre><code>$ sudo mkfs.ext4 /dev/sdb5  # Notice! change sdb to sdX depend on your case
</code></pre>

<p><img src="/images/20140910_format_disk.png" width="600" height="500" title="exame partition table" ></p>

<h4>Mount new disk</h4>

<pre><code>$ mkdir -p /mydisk
$ chmod 777 /mydisk
$ mount -t ext4 /dev/sdb5 /mydisk
</code></pre>

<h4>Add disk into fstab by UUID</h4>

<pre><code>$ sudo blkid
$ sudo vim /etc/fstab   # add 128-bit UUID of /dev/sdb5 into last line
$ tail -n 1 /etc/fstab
UUID=a1cf9f6e-dxxxx-xxxx-xxxx-xxxxxxx1eccf /mydisk  ext4    errors=remount-ro   0   1
</code></pre>

<p><img src="/images/20140910_find_uuid.png" width="600" height="500" title="find uuid" ></p>

<h2>Evaluate disk I/O performance</h2>

<h4>read benchmark</h4>

<pre><code>$ sudo hdparm -Tt /dev/sdb
/dev/sdb:
 Timing cached reads:   30414 MB in  1.99 seconds = 15289.37 MB/sec
 Timing buffered disk reads: 1046 MB in  3.00 seconds = 348.23 MB/sec
$ sudo hdparm -Tt --direct /dev/sdb
/dev/sdb:
 Timing O_DIRECT cached reads:   996 MB in  2.00 seconds = 497.87 MB/sec
 Timing O_DIRECT disk reads: 1444 MB in  3.00 seconds = 480.71 MB/sec
</code></pre>

<p>The <strong>-T</strong> is for <strong>cached read test</strong> while <strong>-t</strong> is for <strong>buffered read</strong>.
Second example with <strong>&ndash;direct</strong> which means assigned O_DIRECT flag in test</p>

<h4>write benchmark</h4>

<pre><code>$ dd if=/dev/zero of=/tmp/output conv=fdatasync bs=4k count=1M; rm -f /tmp/outut
1048576+0 records in
1048576+0 records out
4294967296 bytes (4.3 GB) copied, 32.0625 s, 134 MB/s
$ dd if=/dev/zero of=/ssd/output conv=fdatasync bs=4k count=1M; rm -f /ssd/output
1048576+0 records in
1048576+0 records out
4294967296 bytes (4.3 GB) copied, 8.62645 s, 498 MB/s
</code></pre>

<p>First example I tested my system disk whick is 3.5&#8221; HDD, while second one I tested on SSD.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Intel I217-LM Ethernet on Ubuntu 12.04]]></title>
    <link href="http://gs0622.github.io/blog/2014/09/09/intel-i217-lm-ethernet-on-ubuntu-12-dot-04-lts/"/>
    <updated>2014-09-09T19:04:52+08:00</updated>
    <id>http://gs0622.github.io/blog/2014/09/09/intel-i217-lm-ethernet-on-ubuntu-12-dot-04-lts</id>
    <content type="html"><![CDATA[<p>If you&rsquo;re using Intel I217-LM ethernet on Ubuntu 12.04 LTS, you might get trouble says eth0 is not working on Linux kernel 3.2.x</p>

<h2>Problem</h2>

<p>I used &lsquo;lshw&rsquo; and &lsquo;ifconfig&rsquo; ensured it is detected on PCI but not in NetworkManager</p>

<pre><code>$ sudo lshw -C network
  *-network
   description: Ethernet interface
   product: Ethernet Connection I217-LM
   vendor: Intel Corporation
   physical id: 19
   bus info: pci@0000:00:19.0
   logical name: eth0
...
$ ifconfig
lo      Link encap:Local Loopback
        inet addr:127.0.0.1  Mask:255.0.0.0
        inet6 addr: ::1/128 Scope:Host
        UP LOOPBACK RUNNING  MTU:16436  Metric:1
        RX packets:223 errors:0 dropped:0 overruns:0 frame:0
        TX packets:223 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:0
        RX bytes:141166 (141.1 KB)  TX bytes:141166 (141.1 KB)
wlan0   Link encap:Ethernet  HWaddr xx:xx:xx:xx:xx:xx
        UP BROADCAST MULTICAST  MTU:1500  Metric:1
        RX packets:0 errors:0 dropped:0 overruns:0 frame:0
        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:1000
        RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
</code></pre>

<h2>Solution</h2>

<p>By <a href="http://askubuntu.com/questions/310442/intel-i217lm-ethernet-controller-not-detected-by-ubuntu-12-04lts?#315922">StackOverflow</a> I found potential cause due to I217 driver available since Linux 3.5.x however my Ubuntu 12.04 still using 3.2.0-29, probably it could be found in linux-backports-modules however I did not go the way.</p>

<p>I followed the hint to <a href="http://www.intel.com/support/network/sb/cs-032514.htm">Intel e1000e drivers page</a>, get the source then built on my laptop</p>

<pre><code>$ tar zxf e1000e-&lt;x.x.x&gt;.tar.gz
$ cd e1000e-&lt;x.x.x&gt;/src/
$ sudo make install
$ modprobe e1000e
$ ifconfig
</code></pre>

<p>Have fun on your eth0</p>
]]></content>
  </entry>
  
</feed>
